<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
  <meta name="generator" content="Hugo 0.104.2">
  <title>Harvest Hub</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

  <!-- Custom styles for this template -->
  <link href="product.css" rel="stylesheet">
  <link rel="stylesheet" href="farmerhom.css">
  <style>
    body {
      width: 100vw;
    }
  </style>
</head>

<body>


  <nav class="navbar navbar-dark bg-dark" aria-label="Dark offcanvas navbar">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Harvest Hub</a>
      <div class="photo">
        <img src="#" alt="">
      </div>
      <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbarDark"
        aria-controls="offcanvasNavbarDark">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="offcanvasNavbarDark"
        aria-labelledby="offcanvasNavbarDarkLabel">
        <div class="offcanvas-header">
          <h5 class="offcanvas-title" id="offcanvasNavbarDarkLabel">Offcanvas</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"
            aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
          <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">App Link</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                aria-expanded="false">
                Choose
              </a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#">Food</a></li>
                <li><a class="dropdown-item" href="#">Fish</a></li>
                <li>
                  <hr class="dropdown-divider">
                </li>
                <li><a class="dropdown-item" href="#">Cattle</a></li>
              </ul>
              <li class="nav-item">
                <a class="nav-link" href="/displayfarmerlogin" target="_blank">Farmer Login</a>
              </li>
            </li>
          </ul>
        </div>
  </nav>

  <!--coursel-->
  <div id="carouselExampleDark" class="carousel carousel-dark slide">
    <div class="carousel-indicators">
      <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="0" class="active"
        aria-current="true" aria-label="Slide 1"></button>
      <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="1" aria-label="Slide 2"></button>
      <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="2" aria-label="Slide 3"></button>
    </div>
    <div class="container-main">
      <div class="carousel-inner">
        <div class="carousel-item active" data-bs-interval="10000">
          <img src="slideone.jpg" class="d-block w-100" alt="...">
          <div class="carousel-caption d-none d-md-block">
            <h5>First slide label</h5>
            <p>Some representative placeholder content for the first slide.</p>
          </div>
        </div>
        <div class="carousel-item" data-bs-interval="2000">
          <img src="slidesec.jpg" class="d-block w-100" alt="...">
          <div class="carousel-caption d-none d-md-block">
            <h5>Second slide label</h5>
            <p>Some representative placeholder content for the second slide.</p>
          </div>
        </div>
        <div class="carousel-item">
          <img src="slide3.jpg" class="d-block w-100" alt="...">
          <div class="carousel-caption d-none d-md-block">
            <h5>Third slide label</h5>
            <p>Some representative placeholder content for the third slide.</p>
          </div>
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
  </div>
  <marquee behavior="" direction="" style="cursor: pointer;color:white;">Market Price Average -> Tomatto
    :$5&nbsp;&nbsp;&nbsp;&nbsp;Potato :$4 &nbsp;&nbsp;&nbsp;&nbsp;Rice :$10 &nbsp;&nbsp;&nbsp;&nbsp;Wheet
    :$7&nbsp;&nbsp;&nbsp;&nbsp; Pumkin :$3 </marquee>


    
  <div class="location">
    <div class="lc" style="cursor: pointer;" onclick="getLocation()">
      <div style="display: flex;">
        <img src="location.png" alt="">
        <p id="loc" style="color: white;"></p>
      </div>
    </div>
    <div class="fl">

      <div class="dropdown">
        <button class="dropbtn" style="border: none; background:none; margin-left: -20vh;"><img src="filter.png" alt=""></button>
        <select class="dropdown-content" id="select" style="margin-left: -20vh;">
          <option selected>--select</option>
          <option>Turmeric</option>
          <option>Sugarcane</option>
          <option>corn</option>
          <option>Apple</option>
        </select>
      </div>
    </div>
  </div>


  <div id="product">
    <div class="container-al">
      <div id="product-container">
        <!-- Product cards will be appended here -->
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

  <script>
    function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          showPosition,
          null,
          {
            enableHighAccuracy: true,
            timeout: 5000,
            maximumAge: 0
          });
      } else {
        document.getElementById('loc').innerHTML = "Geolocation is not supported by this browser.";
      }
    }

    async function showPosition(position) {
      const query = `latitude=${position.coords.latitude}&longitude=${position.coords.longitude}`
      try {
        const response = await fetch(`/getloc?${query}`);

        if (!response.ok) {
          throw new Error('Failed to fetch Location');
        }

        let res = await response.json();

        document.getElementById('loc').innerText = res.City;

      } catch (error) {
        console.log(error);
      }
    }

    async function fetchData() {
      try {
        const response = await fetch('/api/getproducts');
        const data = await response.json();
        displayProducts(data);
      } catch (error) {
        console.log('Error', error);
      }
    }

    function displayProducts(products) {
      const productContainer = document.getElementById('product-container');
      productContainer.innerHTML = '';

      products.forEach(product => {
        const productCard = document.createElement('div');
        productCard.className = 'product-card';
        productCard.innerHTML = `
            <img src="${product.imageUrl}" alt="Product Image" class="product-image">
            <div class="product-info">
              <h2 class="product-title">${product.p_name}</h2>
              <p>Farmer Name: ${product.name}</p>
              <span>Plantation Date: ${product.plant_date}</span><br>
              <span>Maturity Date: ${product.maturity_date}</span><br>
              <span style="color: green">â€¢ ${product.organic ? 'Organic' : 'Inorganic'}</span>
              <p class="product-price">Basic Bit $${product.bit_price}</p>
              <input type="text" id="bid" placeholder="Enter Bidding Price">
              <br><br>
              <button style="display:block"; class="add-to-cart" id='sec' onclick="addCart()">Make a bid</button>
            </div>`;
        productContainer.appendChild(productCard);
      });
    }
   
    document.getElementById('select').addEventListener('change', async () => {
      const selectedOption = document.getElementById('select').value;
      console.log(selectedOption);
      try {
        const response = await fetch(`/api/getproducts?name=${selectedOption}`);
        const data = await response.json();
        displayProducts(data);
      } catch (error) {
        console.log('Error', error);
      }
    });

    fetchData();

    function addCart()
    {
      document.querySelectorAll('.add-to-cart').forEach(btn=>{
        btn.addEventListener('click',()=>{
          let parentEl = btn.parentElement;
          let val = parentEl.querySelector('input').value;
          btn.innerText=`Bid made for $${val}`;
          btn.disabled = true;
        });
      });
    }
  </script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
</body>

</html>